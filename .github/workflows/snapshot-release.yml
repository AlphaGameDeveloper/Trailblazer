name: Upload Snapshot Release
on:
    push:
    workflow_dispatch:
    

jobs:
    upload-snapshot:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v4

        - name: Set up JDK 17
          uses: actions/setup-java@v4
          with:
            java-version: '17'
            distribution: 'temurin'
            server-id: github
            settings-path: ${{ github.workspace }}

        - name: Setup Gradle
          uses: gradle/actions/setup-gradle@af1da67850ed9a4cedd57bfd976089dd991e2582

        - name: Build with Gradle
          run: ./gradlew build

        - name: Publish snapshot to maven.alphagame.dev
          run: ./gradlew publishSnapshotToReposilite
          env:
            USERNAME: ${{ github.actor }}
            TOKEN: ${{ secrets.GITHUB_TOKEN }}
            REPOSILITE_USER: ${{ secrets.REPOSILITE_USER }}
            REPOSILITE_PASSWORD: ${{ secrets.REPOSILITE_PASSWORD }}